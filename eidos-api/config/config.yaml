service:
  name: eidos-api
  http_port: 8080
  env: dev

# Nacos Service Discovery
nacos:
  enabled: false
  server_addr: localhost:8848
  namespace: public
  group: EIDOS_GROUP
  username: ""
  password: ""
  timeout_ms: 5000

# Redis Configuration
redis:
  addresses:
    - ${REDIS_ADDR:localhost:6379}
  password: ""
  db: 0
  pool_size: 100           # 连接池大小
  min_idle_conns: 10       # 最小空闲连接数
  max_idle_conns: 50       # 最大空闲连接数
  conn_max_lifetime: 1800  # 连接最大生命周期-秒
  conn_max_idle_time: 300  # 空闲连接最大存活时间-秒
  dial_timeout: 5          # 连接超时-秒
  read_timeout: 3          # 读取超时-秒
  write_timeout: 3         # 写入超时-秒

# gRPC Client Configuration
grpc_clients:
  trading:
    addr: localhost:50051
    timeout_ms: 5000
    max_retry: 3
  matching:
    addr: localhost:50052
    timeout_ms: 5000
    max_retry: 3
  market:
    addr: localhost:50053
    timeout_ms: 5000
    max_retry: 3
  risk:
    addr: localhost:50055
    timeout_ms: 5000
    max_retry: 3
  chain:
    addr: localhost:50054
    timeout_ms: 5000
    max_retry: 3

# EIP-712 Signature Verification
eip712:
  domain:
    name: EidosExchange
    version: "1"
    chain_id: 31337
    verifying_contract: "0x0000000000000000000000000000000000000000"
  mock_mode: true
  timestamp_tolerance_ms: 300000

# Rate Limiting
rate_limit:
  enabled: true
  per_wallet:
    orders: 10
    queries: 100
    withdrawals: 1
    cancels: 20
  per_ip:
    total: 1000
    websocket: 5
    public_api: 100
  global:
    orders: 10000

# WebSocket Configuration
websocket:
  read_buffer_size: 1024
  write_buffer_size: 1024
  ping_interval: 30
  pong_timeout: 10
  max_connections: 100000
  max_subscriptions: 50
  write_wait: 10
  max_message_size: 4096
  allowed_origins:
    - "localhost"
    - "localhost:3000"
    - "localhost:8080"
  allow_all_origins: true
  auth_timeout_sec: 30
  enable_private_auth: true

# Risk Service Integration
risk:
  enabled: true
  fail_open: false

# Prometheus Metrics
metrics:
  enabled: true
  port: 9090
  path: /metrics

# Logging Configuration
log:
  level: info
  format: color

# OpenTelemetry Tracing (Jaeger)
tracing:
  enabled: false                    # 是否启用链路追踪
  endpoint: ${TRACING_ENDPOINT:localhost:4317}  # OTLP gRPC 端点
  sample_rate: 1.0                  # 采样率 (0.0-1.0), 生产环境建议 0.1
  insecure: true                    # 是否使用不安全连接
  timeout_sec: 5                    # 连接超时（秒）

# Health Check
health:
  enabled: true
  path: /health
