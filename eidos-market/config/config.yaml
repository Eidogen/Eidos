service:
  name: eidos-market
  grpc_port: 50053
  http_port: 8082
  env: dev

# Nacos Service Discovery
nacos:
  enabled: false
  server_addr: localhost:8848
  namespace: eidos-dev
  group: EIDOS_GROUP
  username: ""
  password: ""
  log_dir: /tmp/nacos/log
  cache_dir: /tmp/nacos/cache
  timeout_ms: 5000
  heartbeat_interval_ms: 5000

# Database Configuration (TimescaleDB)
postgres:
  host: ${DB_HOST:localhost}
  port: ${DB_PORT:5433}
  database: ${DB_DATABASE:eidos_market}
  user: ${DB_USER:eidos}
  password: ${DB_PASSWORD:eidos123}
  max_connections: 50
  max_idle_conns: 10
  conn_max_lifetime: 3600

# Redis Configuration
redis:
  addresses:
    - ${REDIS_ADDR:localhost:6379}
  password: ""
  db: 0
  pool_size: 100           # 连接池大小
  min_idle_conns: 10       # 最小空闲连接数
  max_idle_conns: 50       # 最大空闲连接数
  conn_max_lifetime: 1800  # 连接最大生命周期-秒
  conn_max_idle_time: 300  # 空闲连接最大存活时间-秒
  dial_timeout: 5          # 连接超时-秒
  read_timeout: 3          # 读取超时-秒
  write_timeout: 3         # 写入超时-秒

# Kafka Configuration
kafka:
  enabled: true
  brokers:
    - ${KAFKA_BROKERS:localhost:9092}
  group_id: eidos-market-group
  client_id: eidos-market
  consumer:
    topics:
      - trade-events
      - order-book-updates
    auto_offset_reset: latest
    max_poll_records: 1000
  producer:
    topics:
      market_data: market-data
      kline_updates: kline-updates
    compression: lz4
    batch_size: 1000
    linger_ms: 5

# gRPC Client Configuration
grpc_clients:
  trading:
    addr: localhost:50051
    timeout_ms: 5000
    max_retry: 3
  matching:
    addr: localhost:50052
    timeout_ms: 5000
    max_retry: 3

# K-Line Configuration
kline:
  intervals:
    - 1m
    - 5m
    - 15m
    - 30m
    - 1h
    - 4h
    - 1d
    - 1w
  retention_days: 365

# Aggregator Configuration
aggregator:
  kline_flush_interval: 10
  ticker_publish_interval: 1000
  depth_publish_interval: 100
  depth_max_levels: 100

# Order Book Configuration
orderbook:
  max_depth: 1000
  snapshot_interval: 60
  broadcast_throttle_ms: 100

# Trade History Configuration
trade_history:
  max_records: 1000
  retention_days: 90

# Prometheus Metrics
metrics:
  enabled: true
  port: 9092
  path: /metrics

# Logging Configuration
log:
  level: info
  format: color

# OpenTelemetry Tracing (Jaeger)
tracing:
  enabled: false                    # 是否启用链路追踪
  endpoint: ${TRACING_ENDPOINT:localhost:4317}  # OTLP gRPC 端点
  sample_rate: 1.0                  # 采样率 (0.0-1.0), 生产环境建议 0.1
  insecure: true                    # 是否使用不安全连接
  timeout_sec: 5                    # 连接超时（秒）

# Health Check
health:
  enabled: true
  path: /health
